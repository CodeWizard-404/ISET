{"version":3,"file":"utils.js","names":["crypto","require","exports","passwordDigestOriginal","passwordDigest","nonce","created","password","pwHash","createHash","rawNonce","Buffer","from","toString","update","digest","concat","TNS_PREFIX","findPrefix","xmlnsMapping","nsURI","n","extend","base","obj","Object","keys","forEach","key","hasOwnProperty","toXMLDate","d","pad","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","createPromiseCallback","cb","promise","Promise","resolve","reject","err","result","envelope","soapHeader"],"sources":["../src/utils.js"],"sourcesContent":["// Copyright IBM Corp. 2016,2019. All Rights Reserved.\n// Node module: strong-soap\n// This file is licensed under the MIT License.\n// License text available at https://opensource.org/licenses/MIT\n\n'use strict';\n\nvar crypto = require('crypto');\nexports.passwordDigestOriginal = function passwordDigest(nonce, created, password) {\n  // digest = base64 ( sha1 ( nonce + created + password ) )\n  var pwHash = crypto.createHash('sha1');\n  var rawNonce = Buffer.from(nonce || '', 'base64').toString('binary');\n  pwHash.update(rawNonce + created + password);\n  return pwHash.digest('base64');\n};\n\nexports.passwordDigest = function (nonce, created, password) {\n  // digest = base64 ( sha1 ( nonce + created + password ) )\n  var pwHash = crypto.createHash('sha1');\n  var rawNonce = Buffer.from(nonce || '', 'base64');\n  pwHash.update(Buffer.concat([\n    rawNonce,\n    Buffer.from(created),\n    Buffer.from(password)\n  ]));\n  return pwHash.digest('base64');\n};\n\nvar TNS_PREFIX = ''; // Prefix for targetNamespace\n\nexports.TNS_PREFIX = TNS_PREFIX;\n\n/**\n * Find a key from an object based on the value\n * @param {Object} Namespace prefix/uri mapping\n * @param {*} nsURI value\n * @returns {String} The matching key\n */\nexports.findPrefix = function(xmlnsMapping, nsURI) {\n  for (var n in xmlnsMapping) {\n    if (n === TNS_PREFIX) continue;\n    if (xmlnsMapping[n] === nsURI) {\n      return n;\n    }\n  }\n};\n\nexports.extend = function extend(base, obj) {\n  if (base !== null && typeof base === \"object\" &&\n    obj !== null && typeof obj === \"object\") {\n    Object.keys(obj).forEach(function(key) {\n      if (!base.hasOwnProperty(key))\n        base[key] = obj[key];\n    });\n  }\n  return base;\n};\n\nexports.toXMLDate = function(d) {\n  function pad(n) {\n    return n < 10 ? '0' + n : n;\n  }\n\n  return d.getUTCFullYear() + '-'\n    + pad(d.getUTCMonth() + 1) + '-'\n    + pad(d.getUTCDate()) + 'T'\n    + pad(d.getUTCHours()) + ':'\n    + pad(d.getUTCMinutes()) + ':'\n    + pad(d.getUTCSeconds()) + 'Z';\n};\n\nexports.createPromiseCallback = function createPromiseCallback() {\n  var cb;\n  var promise = new Promise(function(resolve, reject) {\n    cb = function(err, result, envelope, soapHeader) {\n      if (err) {\n        reject(err);\n      } else {\n        resolve({result, envelope, soapHeader});\n      }\n    }\n  });\n  cb.promise = promise;\n  return cb;\n}\n\n"],"mappings":"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","ignoreList":[]}