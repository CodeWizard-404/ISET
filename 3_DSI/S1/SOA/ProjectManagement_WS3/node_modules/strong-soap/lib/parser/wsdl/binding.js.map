{"version":3,"file":"binding.js","names":["WSDLElement","require","QName","Binding","constructor","nsName","attrs","options","transport","style","addChild","child","name","$transport","$style","postProcess","definitions","operations","type","parse","$type","portType","portTypes","children","i","operation","$name","input","message","output","f","faults","$parameterOrder","parameterOrder","split","err","describe","descriptor","elementName","allowedChildren","module","exports"],"sources":["../../../src/parser/wsdl/binding.js"],"sourcesContent":["// Copyright IBM Corp. 2016,2018. All Rights Reserved.\n// Node module: strong-soap\n// This file is licensed under the MIT License.\n// License text available at https://opensource.org/licenses/MIT\n\n'use strict';\n\nvar WSDLElement = require('./wsdlElement');\nvar QName = require('../qname');\n\nclass Binding extends WSDLElement {\n  constructor(nsName, attrs, options) {\n    super(nsName, attrs, options);\n    this.transport = '';\n    this.style = '';\n  }\n\n  addChild(child) {\n    // soap:binding\n    if (child.name === 'binding') {\n      this.transport = child.$transport;\n      this.style = child.$style;\n    }\n  }\n\n  postProcess(definitions) {\n    if (this.operations) return;\n    try {\n      this.operations = {};\n      var type = QName.parse(this.$type).name,\n        portType = definitions.portTypes[type],\n        style = this.style,\n        children = this.children;\n      if (portType) {\n        portType.postProcess(definitions);\n        this.portType = portType;\n\n        for (var i = 0, child; child = children[i]; i++) {\n          if (child.name !== 'operation')\n            continue;\n          var operation = this.portType.operations[child.$name];\n          if (operation) {\n            this.operations[child.$name] = child;\n            child.operation = operation;\n\n            // Set portType.operation.input.message to binding.operation.input\n            if (operation.input && child.input) {\n              child.input.message = operation.input.message;\n            }\n            // Set portType.operation.output.message to binding.operation.output\n            if (operation.output && child.output) {\n              child.output.message = operation.output.message;\n            }\n\n            //portType.operation.fault is fully processed with message etc. Hence set to binding.operation.fault\n            for (var f in operation.faults) {\n              if (operation.faults[f]) {\n                child.faults[f] = operation.faults[f];\n              }\n            }\n            if (operation.$parameterOrder) {\n              // For RPC style\n              child.parameterOrder = operation.$parameterOrder.split(/\\s+/);\n            }\n            child.style = child.style || style;\n            child.postProcess(definitions);\n          }\n        }\n      }\n    } catch (err) {\n      throw err;\n    }\n  }\n\n  describe(definitions) {\n    if (this.descriptor) return this.descriptor;\n    var operations = this.descriptor = {};\n    for (var name in this.operations) {\n      var operation = this.operations[name];\n      operations[name] = operation.describe(definitions);\n    }\n    return operations;\n  };\n}\n\nBinding.elementName = 'binding';\nBinding.allowedChildren = ['binding', 'SecuritySpec', 'operation',\n  'documentation'];\n\nmodule.exports = Binding;\n"],"mappings":"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","ignoreList":[]}