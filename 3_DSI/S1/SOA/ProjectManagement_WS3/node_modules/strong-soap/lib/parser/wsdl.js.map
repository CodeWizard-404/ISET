{"version":3,"file":"wsdl.js","names":["g","require","sax","HttpClient","fs","url","path","assert","stripBom","debug","debugInclude","_","selectn","utils","EMPTY_PREFIX","QName","Definitions","Schema","Types","Element","WSDL","constructor","definition","uri","options","content","_includesWsdl","WSDL_CACHE","_initializeOptions","load","callback","_loadAsyncOrSync","err","wsdl","loadSync","result","syncLoad","self","fromFunc","_fromXML","_fromServices","isLoaded","loadUpSchemas","call","e","processIncludes","name","schemas","definitions","s","postProcess","services","bindings","bindingName","binding","style","operations","topEls","topElements","methodName","input","inputName","$name","outputName","output","xmlnsInEnvelope","_xmlnsMap","process","nextTick","_originalIgnoredNamespaces","ignoredNamespaces","Array","isArray","namespaces","override","concat","forceSoapVersion","valueKey","xmlKey","wsdl_headers","wsdl_options","httpClient","request","ignoreBaseNameSpaces","NTLMSecurity","_processNextInclude","includes","include","shift","includePath","test","location","resolve","dirname","assign","staticLoad","push","undefined","namespace","mergeWith","a","b","merge","type","$targetNamespace","deepMerge","ns","schema","describeServices","service","describe","toXML","xml","xmlToObject","root","_parse","p","parser","trim","stack","types","text","onopentag","node","nsName","attrs","attributes","top","length","startElement","message","strict","parse","addChild","Error","f","onclosetag","endElement","ontext","str","write","close","xmlns","prefix","indexOf","fromCache","open","request_headers","request_options","readFile","response","statusCode","wsdlUri","get","body","openSync","loadSystemSchemas","xsdDir","join","__dirname","done","readdir","files","count","forEach","prototype","module","exports","destination","source"],"sources":["../../src/parser/wsdl.js"],"sourcesContent":["// Copyright IBM Corp. 2016,2019. All Rights Reserved.\n// Node module: strong-soap\n// This file is licensed under the MIT License.\n// License text available at https://opensource.org/licenses/MIT\n\n'use strict';\n\nvar g = require('../globalize');\nvar sax = require('sax');\nvar HttpClient = require('./../http');\nvar fs = require('fs');\nvar url = require('url');\nvar path = require('path');\nvar assert = require('assert');\nvar stripBom = require('../strip-bom');\nvar debug = require('debug')('strong-soap:wsdl');\nvar debugInclude = require('debug')('strong-soap:wsdl:include');\nvar _ = require('lodash');\nvar selectn = require('selectn');\nvar utils = require('./helper');\nvar EMPTY_PREFIX = utils.EMPTY_PREFIX;\n\nvar QName = require('./qname');\nvar Definitions = require('./wsdl/definitions');\nvar Schema = require('./xsd/schema');\nvar Types = require('./wsdl/types');\nvar Element = require('./element');\n\nclass WSDL {\n  constructor(definition, uri, options) {\n    this.content = definition;\n    assert(this.content != null && (typeof this.content === 'string' ||\n      typeof this.content === 'object'),\n      'WSDL constructor takes either an XML string or definitions object');\n    this.uri = uri;\n    this._includesWsdl = [];\n\n    // initialize WSDL cache\n    this.WSDL_CACHE = (options || {}).WSDL_CACHE || {};\n    this._initializeOptions(options);\n  }\n\n  load(callback) {\n    this._loadAsyncOrSync(false, function (err, wsdl) {\n      callback(err,wsdl);\n    });\n  }\n\n  loadSync() {\n    var result;\n    this._loadAsyncOrSync(true, function (err, wsdl) {\n        result = wsdl;\n    });\n    // This is not intuitive but works as the load function and its callback all are executed before the\n    // loadSync function returns. The outcome here is that the following result is always set correctly.\n    return result;\n  }\n\n  _loadAsyncOrSync(syncLoad, callback) {\n    var self = this;\n    var definition = this.content;\n    let fromFunc;\n    if (typeof definition === 'string') {\n      definition = stripBom(definition);\n      fromFunc = this._fromXML;\n    }\n    else if (typeof definition === 'object') {\n      fromFunc = this._fromServices;\n    }\n\n    // register that this WSDL has started loading\n    self.isLoaded = true;\n\n    var loadUpSchemas = function(syncLoad) {\n      try {\n        fromFunc.call(self, definition);\n      } catch (e) {\n        return callback(e);\n      }\n\n      self.processIncludes(syncLoad, function(err) {\n        var name;\n        if (err) {\n          return callback(err);\n        }\n\n        var schemas = self.definitions.schemas;\n        for (let s in schemas) {\n          schemas[s].postProcess(self.definitions);\n        }\n        var services = self.services = self.definitions.services;\n        if (services) {\n          for (let s in services) {\n            try {\n              services[s].postProcess(self.definitions);\n            } catch (err) {\n              return callback(err);\n            }\n          }\n        }\n\n        // for document style, for every binding, prepare input message\n        // element name to (methodName, output message element name) mapping\n        var bindings = self.definitions.bindings;\n        for (var bindingName in bindings) {\n          var binding = bindings[bindingName];\n          if (binding.style == null) {\n            binding.style = 'document';\n          }\n          if (binding.style !== 'document')\n            continue;\n          var operations = binding.operations;\n          var topEls = binding.topElements = {};\n          for (var methodName in operations) {\n            if (operations[methodName].input) {\n              var inputName = operations[methodName].input.$name;\n              var outputName = \"\";\n              if (operations[methodName].output)\n                outputName = operations[methodName].output.$name;\n              topEls[inputName] = {\n                \"methodName\": methodName,\n                \"outputName\": outputName\n              };\n            }\n          }\n        }\n\n        // prepare soap envelope xmlns definition string\n        self.xmlnsInEnvelope = self._xmlnsMap();\n        callback(err, self);\n      });\n    }\n\n    if (syncLoad) {\n      loadUpSchemas(true);\n    } else {\n      process.nextTick(loadUpSchemas);\n    }\n  }\n\n  _initializeOptions(options) {\n    this._originalIgnoredNamespaces = (options || {}).ignoredNamespaces;\n    this.options = {};\n\n    var ignoredNamespaces = options ? options.ignoredNamespaces : null;\n\n    if (ignoredNamespaces &&\n      (Array.isArray(ignoredNamespaces.namespaces) ||\n      typeof ignoredNamespaces.namespaces === 'string')) {\n      if (ignoredNamespaces.override) {\n        this.options.ignoredNamespaces = ignoredNamespaces.namespaces;\n      } else {\n        this.options.ignoredNamespaces =\n          this.ignoredNamespaces.concat(ignoredNamespaces.namespaces);\n      }\n    } else {\n      this.options.ignoredNamespaces = this.ignoredNamespaces;\n    }\n\n    this.options.forceSoapVersion = options.forceSoapVersion;\n\n    this.options.valueKey = options.valueKey || this.valueKey;\n    this.options.xmlKey = options.xmlKey || this.xmlKey;\n\n    // Allow any request headers to keep passing through\n    this.options.wsdl_headers = options.wsdl_headers;\n    this.options.wsdl_options = options.wsdl_options;\n\n    if (options.httpClient) {\n      this.options.httpClient = options.httpClient;\n    }\n    \n    if (options.request) {\n      this.options.request = options.request;\n    }\n\n    var ignoreBaseNameSpaces = options ? options.ignoreBaseNameSpaces : null;\n    if (ignoreBaseNameSpaces !== null &&\n      typeof ignoreBaseNameSpaces !== 'undefined')\n      this.options.ignoreBaseNameSpaces = ignoreBaseNameSpaces;\n    else\n      this.options.ignoreBaseNameSpaces = this.ignoreBaseNameSpaces;\n\n    if (options.NTLMSecurity) {\n      this.options.NTLMSecurity = options.NTLMSecurity;\n    }\n  }\n\n  _processNextInclude(syncLoad, includes, callback) {\n    debugInclude('includes/imports: ', includes);\n    var self = this,\n      include = includes.shift(),\n      options;\n\n    if (!include)\n      return callback();\n\n    // if undefined treat as \"\" to make path.dirname return '.' as errors on non string below\n    if (!self.uri) {\n      self.uri='';\n    }\n\n    var includePath;\n    if (!/^https?:/.test(self.uri) && !/^https?:/.test(include.location)) {\n      includePath = path.resolve(path.dirname(self.uri), include.location);\n    } else {\n      includePath = url.resolve(self.uri, include.location);\n    }\n\n    debugInclude('Processing: ', include, includePath);\n\n    options = _.assign({}, this.options);\n    // follow supplied ignoredNamespaces option\n    options.ignoredNamespaces = this._originalIgnoredNamespaces || this.options.ignoredNamespaces;\n    options.WSDL_CACHE = this.WSDL_CACHE;\n\n    var staticLoad = function(syncLoad, err, wsdl) {\n      if (err) {\n        return callback(err);\n      }\n\n      self._includesWsdl.push(wsdl);\n\n      if (wsdl.definitions instanceof Definitions) {\n        // Set namespace for included schema that does not have targetNamespace\n        if (undefined in wsdl.definitions.schemas) {\n          if (include.namespace != null) {\n            // If A includes B and B includes C, B & C can both have no targetNamespace\n            wsdl.definitions.schemas[include.namespace] = wsdl.definitions.schemas[undefined];\n            delete wsdl.definitions.schemas[undefined];\n          }\n        }\n        _.mergeWith(self.definitions, wsdl.definitions, function (a, b) {\n          if (a === b) {\n            return a;\n          }\n          return (a instanceof Schema) ? a.merge(b, include.type === 'include') : undefined;\n        });\n      } else {\n        self.definitions.schemas[include.namespace ||\n        wsdl.definitions.$targetNamespace] =\n          deepMerge(self.definitions.schemas[include.namespace ||\n          wsdl.definitions.$targetNamespace], wsdl.definitions);\n      }\n      self._processNextInclude(syncLoad, includes, function (err) {\n        callback(err);\n      });\n    };\n\n    if (syncLoad) {\n      var wsdl = WSDL.loadSync(includePath, options);\n      staticLoad(true, null, wsdl);\n    } else {\n      WSDL.load(includePath, options, function (err, wsdl) {\n        staticLoad(false, err, wsdl);\n      });\n\n    }\n\n  }\n\n  processIncludes(syncLoad, callback) {\n    var schemas = this.definitions.schemas,\n      includes = [];\n\n    for (var ns in schemas) {\n      var schema = schemas[ns];\n      includes = includes.concat(schema.includes || []);\n    }\n\n    this._processNextInclude(syncLoad, includes, callback);\n  }\n\n  describeServices() {\n    var services = {};\n    for (var name in this.services) {\n      var service = this.services[name];\n      services[name] = service.describe(this.definitions);\n    }\n    return services;\n  }\n\n  toXML() {\n    return this.xml || '';\n  }\n\n  xmlToObject(xml) {\n    return root;\n  }\n\n  _parse(xml) {\n    var self = this,\n      p = sax.parser(true, {trim: true}),\n      stack = [],\n      root = null,\n      types = null,\n      schema = null,\n      text = '',\n      options = self.options;\n\n    p.onopentag = function(node) {\n      debug('Start element: %j', node);\n      text = ''; // reset text\n      var nsName = node.name;\n      var attrs = node.attributes;\n\n      var top = stack[stack.length - 1];\n      var name;\n      if (top) {\n        try {\n          top.startElement(stack, nsName, attrs, options);\n        } catch (e) {\n          debug(\"WSDL error: %s \", e.message);\n          if (self.options.strict) {\n            throw e;\n          } else {\n            stack.push(new Element(nsName, attrs, options));\n          }\n        }\n      } else {\n        name = QName.parse(nsName).name;\n        if (name === 'definitions') {\n          root = new Definitions(nsName, attrs, options);\n          stack.push(root);\n        } else if (name === 'schema') {\n          // Shim a structure in here to allow the proper objects to be\n          // created when merging back.\n          root = new Definitions('definitions', {}, {});\n          types = new Types('types', {}, {});\n          schema = new Schema(nsName, attrs, options);\n          types.addChild(schema);\n          root.addChild(types);\n          stack.push(schema);\n        } else {\n          throw new Error(g.f('Unexpected root element of {{WSDL}} or include'));\n        }\n      }\n    };\n\n    p.onclosetag = function(name) {\n      debug('End element: %s', name);\n      var top = stack[stack.length - 1];\n      assert(top, 'Unmatched close tag: ' + name);\n\n      if (text) {\n        top[self.options.valueKey] = text;\n        text = '';\n      }\n      top.endElement(stack, name);\n    };\n\n    p.ontext = function(str) {\n      text = text + str;\n    }\n\n    debug('WSDL xml: %s', xml);\n    p.write(xml).close();\n\n    return root;\n  };\n\n  _fromXML(xml) {\n    this.definitions = this._parse(xml);\n    this.xml = xml;\n  }\n\n  _fromServices(services) {\n  }\n\n  _xmlnsMap() {\n    var xmlns = this.definitions.xmlns;\n    var str = '';\n    for (var prefix in xmlns) {\n      if (prefix === '' || prefix === EMPTY_PREFIX)\n        continue;\n      var ns = xmlns[prefix];\n      switch (ns) {\n        case \"http://xml.apache.org/xml-soap\" : // apachesoap\n        case \"http://schemas.xmlsoap.org/wsdl/\" : // wsdl\n        case \"http://schemas.xmlsoap.org/wsdl/soap/\" : // wsdlsoap\n        case \"http://schemas.xmlsoap.org/wsdl/soap12/\": // wsdlsoap12\n        case \"http://schemas.xmlsoap.org/soap/encoding/\" : // soapenc\n        case \"http://www.w3.org/2001/XMLSchema\" : // xsd\n          continue;\n      }\n      if (~ns.indexOf('http://schemas.xmlsoap.org/'))\n        continue;\n      if (~ns.indexOf('http://www.w3.org/'))\n        continue;\n      if (~ns.indexOf('http://xml.apache.org/'))\n        continue;\n      str += ' xmlns:' + prefix + '=\"' + ns + '\"';\n    }\n    return str;\n  };\n\n  /*\n   * Have another function to load previous WSDLs as we\n   * don't want this to be invoked externally (expect for tests)\n   * This will attempt to fix circular dependencies with XSD files,\n   * Given\n   * - file.wsdl\n   *   - xs:import namespace=\"A\" schemaLocation: A.xsd\n   * - A.xsd\n   *   - xs:import namespace=\"B\" schemaLocation: B.xsd\n   * - B.xsd\n   *   - xs:import namespace=\"A\" schemaLocation: A.xsd\n   * file.wsdl will start loading, import A, then A will import B, which will then import A\n   * Because A has already started to load previously it will be returned right away and\n   * have an internal circular reference\n   * B would then complete loading, then A, then file.wsdl\n   * By the time file A starts processing its includes its definitions will be already loaded,\n   * this is the only thing that B will depend on when \"opening\" A\n   */\n  static load(uri, options, callback) {\n    var fromCache,\n      WSDL_CACHE;\n\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    WSDL_CACHE = options.WSDL_CACHE;\n\n    if (fromCache = WSDL_CACHE[uri]) {\n      /**\n       * Only return from the cache is the document is fully (or partially)\n       * loaded. This allows the contents of a document to have been read\n       * into the cache, but with no processing performed on it yet.\n       */\n      if(fromCache.isLoaded){\n        return callback.call(fromCache, null, fromCache);\n      }\n    }\n\n    return WSDL.open(uri, options, callback);\n  }\n\n  static open(uri, options, callback) {\n    if (typeof options === 'function') {\n      callback = options;\n      options = {};\n    }\n\n    // initialize cache when calling open directly\n    var WSDL_CACHE = options.WSDL_CACHE || {};\n    var request_headers = options.wsdl_headers;\n    var request_options = options.wsdl_options;\n\n    debug('wsdl open. request_headers: %j request_options: %j', request_headers, request_options);\n    var wsdl;\n    var fromCache = WSDL_CACHE[uri];\n    /**\n     * If the file is fully loaded in the cache, return it.\n     * Otherwise load it from the file system or URL.\n     */\n    if (fromCache && !fromCache.isLoaded) {\n      fromCache.load(callback);\n    }\n    else if (!/^https?:/.test(uri)) {\n      debug('Reading file: %s', uri);\n      fs.readFile(uri, 'utf8', function(err, definition) {\n        if (err) {\n          callback(err);\n        }\n        else {\n          wsdl = new WSDL(definition, uri, options);\n          WSDL_CACHE[uri] = wsdl;\n          wsdl.WSDL_CACHE = WSDL_CACHE;\n          wsdl.load(callback);\n        }\n      });\n    }\n    else {\n      var httpClient = options.httpClient || new HttpClient(options);\n      httpClient.request(uri, null /* options */,\n        function(err, response, definition) {\n          if (err) {\n            callback(err);\n          } else if (response && response.statusCode === 200) {\n            const wsdlUri = _.get(response, 'request.uri.href', uri);\n            wsdl = new WSDL(definition, wsdlUri, options);\n            WSDL_CACHE[wsdlUri] = wsdl;\n            wsdl.WSDL_CACHE = WSDL_CACHE;\n            wsdl.load(callback);\n          } else {\n            callback(new Error(g.f('Invalid {{WSDL URL}}: %s\\n\\n\\r Code: %s' +\n              \"\\n\\n\\r Response Body: %j\", uri, response.statusCode, response.body)));\n          }\n        }, request_headers, request_options);\n    }\n\n    return wsdl;\n  }\n\n  static loadSync(uri, options) {\n    var fromCache,\n      WSDL_CACHE;\n\n    if (!options) {\n      options = {};\n    }\n\n    WSDL_CACHE = options.WSDL_CACHE;\n\n    if (fromCache = WSDL_CACHE[uri]) {\n      /**\n       * Only return from the cache is the document is fully (or partially)\n       * loaded. This allows the contents of a document to have been read\n       * into the cache, but with no processing performed on it yet.\n       */\n      if(fromCache.isLoaded){\n        return fromCache;\n      }\n    }\n\n    return WSDL.openSync(uri, options);\n  }\n\n  static openSync(uri, options) {\n    if (!options) {\n      options = {};\n    }\n\n    // initialize cache when calling open directly\n    var WSDL_CACHE = options.WSDL_CACHE || {};\n    var request_headers = options.wsdl_headers;\n    var request_options = options.wsdl_options;\n\n    debug('wsdl open. request_headers: %j request_options: %j', request_headers, request_options);\n    var wsdl;\n    var fromCache = WSDL_CACHE[uri];\n    /**\n     * If the file is fully loaded in the cache, return it.\n     * Otherwise throw an error as we cannot load this in a sync way as we would need to perform IO\n     * either to the filesystem or http\n     */\n    if (fromCache && !fromCache.isLoaded) {\n      wsdl = fromCache.loadSync();\n    } else {\n      throw(uri+\" was not found in the cache. For loadSync() calls all schemas must be preloaded into the cache\");\n    }\n\n    return wsdl;\n  }\n\n  static loadSystemSchemas(callback) {\n    var xsdDir = path.join(__dirname, '../../xsds/');\n    var done = false;\n    fs.readdir(xsdDir, function(err, files) {\n      if (err) return callback(err);\n      var schemas = {};\n      var count = files.length;\n      files.forEach(function(f) {\n        WSDL.open(path.join(xsdDir, f), {}, function(err, wsdl) {\n          if (done) return;\n          count--;\n          if (err) {\n            done = true;\n            return callback(err);\n          }\n          for (var s in wsdl.definitions.schemas) {\n            schemas[s] = wsdl.definitions.schemas[s];\n          }\n          if (count === 0) {\n            done = true;\n            callback(null, schemas);\n          }\n        });\n      });\n    });\n  }\n}\n\nWSDL.prototype.ignoredNamespaces = ['targetNamespace', 'typedNamespace'];\nWSDL.prototype.ignoreBaseNameSpaces = false;\nWSDL.prototype.valueKey = '$value';\nWSDL.prototype.xmlKey = '$xml';\n\nmodule.exports = WSDL;\n\nfunction deepMerge(destination, source) {\n  return _.mergeWith(destination || {}, source, function(a, b) {\n    return _.isArray(a) ? a.concat(b) : undefined;\n  });\n}\n"],"mappings":"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","ignoreList":[]}