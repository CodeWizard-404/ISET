{"version":3,"file":"ClientSSLSecurity.js","names":["g","require","fs","https","_","Security","ClientSSLSecurity","constructor","key","cert","ca","options","Buffer","isBuffer","readFileSync","Error","f","Array","isArray","addOptions","merge","agent","Agent","module","exports"],"sources":["../../src/security/ClientSSLSecurity.js"],"sourcesContent":["// Copyright IBM Corp. 2016. All Rights Reserved.\n// Node module: strong-soap\n// This file is licensed under the MIT License.\n// License text available at https://opensource.org/licenses/MIT\n\n'use strict';\n\nvar g = require('../globalize');\nvar fs = require('fs')\n  , https = require('https')\n  , _ = require('lodash')\n  , Security = require('./security');\n\nclass ClientSSLSecurity extends Security {\n\n  /**\n   * activates SSL for an already existing client\n   *\n   * @module ClientSSLSecurity\n   * @param {Buffer|String}   key\n   * @param {Buffer|String}   cert\n   * @param {Buffer|String|Array}   [ca]\n   * @param {Object}          [options]\n   * @constructor\n   */\n  constructor(key, cert, ca, options) {\n    super(options);\n    if (key) {\n      if (Buffer.isBuffer(key)) {\n        this.key = key;\n      } else if (typeof key === 'string') {\n        this.key = fs.readFileSync(key);\n      } else {\n        throw new Error(g.f('{{key}} should be a {{buffer}} or a {{string}}!'));\n      }\n    }\n\n    if (cert) {\n      if (Buffer.isBuffer(cert)) {\n        this.cert = cert;\n      } else if (typeof cert === 'string') {\n        this.cert = fs.readFileSync(cert);\n      } else {\n        throw new Error(g.f('{{cert}} should be a {{buffer}} or a {{string}}!'));\n      }\n    }\n\n    if (ca) {\n      if (Buffer.isBuffer(ca) || Array.isArray(ca)) {\n        this.ca = ca;\n      } else if (typeof ca === 'string') {\n        this.ca = fs.readFileSync(ca);\n      } else {\n        this.options = ca;\n        this.ca = null;\n      }\n    }\n  }\n\n  addOptions(options) {\n    options.key = this.key;\n    options.cert = this.cert;\n    options.ca = this.ca;\n    _.merge(options, this.options);\n    options.agent = new https.Agent(options);\n  };\n}\n\nmodule.exports = ClientSSLSecurity;\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,YAAY;;AAEZ,IAAIA,CAAC,GAAGC,OAAO,CAAC,cAAc,CAAC;AAC/B,IAAIC,EAAE,GAAGD,OAAO,CAAC,IAAI,CAAC;EAClBE,KAAK,GAAGF,OAAO,CAAC,OAAO,CAAC;EACxBG,CAAC,GAAGH,OAAO,CAAC,QAAQ,CAAC;EACrBI,QAAQ,GAAGJ,OAAO,CAAC,YAAY,CAAC;AAEpC,MAAMK,iBAAiB,SAASD,QAAQ,CAAC;EAEvC;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACEE,WAAWA,CAACC,GAAG,EAAEC,IAAI,EAAEC,EAAE,EAAEC,OAAO,EAAE;IAClC,KAAK,CAACA,OAAO,CAAC;IACd,IAAIH,GAAG,EAAE;MACP,IAAII,MAAM,CAACC,QAAQ,CAACL,GAAG,CAAC,EAAE;QACxB,IAAI,CAACA,GAAG,GAAGA,GAAG;MAChB,CAAC,MAAM,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;QAClC,IAAI,CAACA,GAAG,GAAGN,EAAE,CAACY,YAAY,CAACN,GAAG,CAAC;MACjC,CAAC,MAAM;QACL,MAAM,IAAIO,KAAK,CAACf,CAAC,CAACgB,CAAC,CAAC,iDAAiD,CAAC,CAAC;MACzE;IACF;IAEA,IAAIP,IAAI,EAAE;MACR,IAAIG,MAAM,CAACC,QAAQ,CAACJ,IAAI,CAAC,EAAE;QACzB,IAAI,CAACA,IAAI,GAAGA,IAAI;MAClB,CAAC,MAAM,IAAI,OAAOA,IAAI,KAAK,QAAQ,EAAE;QACnC,IAAI,CAACA,IAAI,GAAGP,EAAE,CAACY,YAAY,CAACL,IAAI,CAAC;MACnC,CAAC,MAAM;QACL,MAAM,IAAIM,KAAK,CAACf,CAAC,CAACgB,CAAC,CAAC,kDAAkD,CAAC,CAAC;MAC1E;IACF;IAEA,IAAIN,EAAE,EAAE;MACN,IAAIE,MAAM,CAACC,QAAQ,CAACH,EAAE,CAAC,IAAIO,KAAK,CAACC,OAAO,CAACR,EAAE,CAAC,EAAE;QAC5C,IAAI,CAACA,EAAE,GAAGA,EAAE;MACd,CAAC,MAAM,IAAI,OAAOA,EAAE,KAAK,QAAQ,EAAE;QACjC,IAAI,CAACA,EAAE,GAAGR,EAAE,CAACY,YAAY,CAACJ,EAAE,CAAC;MAC/B,CAAC,MAAM;QACL,IAAI,CAACC,OAAO,GAAGD,EAAE;QACjB,IAAI,CAACA,EAAE,GAAG,IAAI;MAChB;IACF;EACF;EAEAS,UAAUA,CAACR,OAAO,EAAE;IAClBA,OAAO,CAACH,GAAG,GAAG,IAAI,CAACA,GAAG;IACtBG,OAAO,CAACF,IAAI,GAAG,IAAI,CAACA,IAAI;IACxBE,OAAO,CAACD,EAAE,GAAG,IAAI,CAACA,EAAE;IACpBN,CAAC,CAACgB,KAAK,CAACT,OAAO,EAAE,IAAI,CAACA,OAAO,CAAC;IAC9BA,OAAO,CAACU,KAAK,GAAG,IAAIlB,KAAK,CAACmB,KAAK,CAACX,OAAO,CAAC;EAC1C;AACF;AAEAY,MAAM,CAACC,OAAO,GAAGlB,iBAAiB","ignoreList":[]}