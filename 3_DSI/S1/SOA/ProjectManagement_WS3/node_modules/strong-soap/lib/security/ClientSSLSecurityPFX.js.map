{"version":3,"file":"ClientSSLSecurityPFX.js","names":["g","require","fs","https","_","Security","ClientSSLSecurityPFX","constructor","pfx","passphrase","options","Buffer","isBuffer","readFileSync","Error","f","merge","addOptions","agent","Agent","module","exports"],"sources":["../../src/security/ClientSSLSecurityPFX.js"],"sourcesContent":["// Copyright IBM Corp. 2016. All Rights Reserved.\n// Node module: strong-soap\n// This file is licensed under the MIT License.\n// License text available at https://opensource.org/licenses/MIT\n\n'use strict';\n\nvar g = require('../globalize');\nvar fs = require('fs')\n  , https = require('https')\n  , _ = require('lodash')\n  , Security = require('./security');\n\nclass ClientSSLSecurityPFX extends Security {\n\n  /**\n   * activates SSL for an already existing client using a PFX cert\n   *\n   * @module ClientSSLSecurityPFX\n   * @param {Buffer|String}   pfx\n   * @param {String}   passphrase\n   * @constructor\n   */\n  constructor(pfx, passphrase, options) {\n    super(options);\n\n    if (typeof passphrase === 'object') {\n      options = passphrase;\n    }\n    if (pfx) {\n      if (Buffer.isBuffer(pfx)) {\n        this.pfx = pfx;\n      } else if (typeof pfx === 'string') {\n        this.pfx = fs.readFileSync(pfx);\n      } else {\n        throw new Error(g.f(\n          'supplied {{pfx}} file should be a {{buffer}} or a file location'));\n      }\n    }\n\n    if (passphrase) {\n      if (typeof passphrase === 'string') {\n        this.passphrase = passphrase;\n      }\n    }\n    this.options = {};\n    _.merge(this.options, options);\n  }\n\n  addOptions(options) {\n    options.pfx = this.pfx;\n    if (this.passphrase) {\n      options.passphrase = this.passphrase;\n    }\n    _.merge(options, this.options);\n    options.agent = new https.Agent(options);\n  }\n}\n\nmodule.exports = ClientSSLSecurityPFX;\n"],"mappings":"AAAA;AACA;AACA;AACA;;AAEA,YAAY;;AAEZ,IAAIA,CAAC,GAAGC,OAAO,CAAC,cAAc,CAAC;AAC/B,IAAIC,EAAE,GAAGD,OAAO,CAAC,IAAI,CAAC;EAClBE,KAAK,GAAGF,OAAO,CAAC,OAAO,CAAC;EACxBG,CAAC,GAAGH,OAAO,CAAC,QAAQ,CAAC;EACrBI,QAAQ,GAAGJ,OAAO,CAAC,YAAY,CAAC;AAEpC,MAAMK,oBAAoB,SAASD,QAAQ,CAAC;EAE1C;AACF;AACA;AACA;AACA;AACA;AACA;AACA;EACEE,WAAWA,CAACC,GAAG,EAAEC,UAAU,EAAEC,OAAO,EAAE;IACpC,KAAK,CAACA,OAAO,CAAC;IAEd,IAAI,OAAOD,UAAU,KAAK,QAAQ,EAAE;MAClCC,OAAO,GAAGD,UAAU;IACtB;IACA,IAAID,GAAG,EAAE;MACP,IAAIG,MAAM,CAACC,QAAQ,CAACJ,GAAG,CAAC,EAAE;QACxB,IAAI,CAACA,GAAG,GAAGA,GAAG;MAChB,CAAC,MAAM,IAAI,OAAOA,GAAG,KAAK,QAAQ,EAAE;QAClC,IAAI,CAACA,GAAG,GAAGN,EAAE,CAACW,YAAY,CAACL,GAAG,CAAC;MACjC,CAAC,MAAM;QACL,MAAM,IAAIM,KAAK,CAACd,CAAC,CAACe,CAAC,CACjB,iEAAiE,CAAC,CAAC;MACvE;IACF;IAEA,IAAIN,UAAU,EAAE;MACd,IAAI,OAAOA,UAAU,KAAK,QAAQ,EAAE;QAClC,IAAI,CAACA,UAAU,GAAGA,UAAU;MAC9B;IACF;IACA,IAAI,CAACC,OAAO,GAAG,CAAC,CAAC;IACjBN,CAAC,CAACY,KAAK,CAAC,IAAI,CAACN,OAAO,EAAEA,OAAO,CAAC;EAChC;EAEAO,UAAUA,CAACP,OAAO,EAAE;IAClBA,OAAO,CAACF,GAAG,GAAG,IAAI,CAACA,GAAG;IACtB,IAAI,IAAI,CAACC,UAAU,EAAE;MACnBC,OAAO,CAACD,UAAU,GAAG,IAAI,CAACA,UAAU;IACtC;IACAL,CAAC,CAACY,KAAK,CAACN,OAAO,EAAE,IAAI,CAACA,OAAO,CAAC;IAC9BA,OAAO,CAACQ,KAAK,GAAG,IAAIf,KAAK,CAACgB,KAAK,CAACT,OAAO,CAAC;EAC1C;AACF;AAEAU,MAAM,CAACC,OAAO,GAAGf,oBAAoB","ignoreList":[]}